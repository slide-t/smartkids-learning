<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Learning Kids - Mouse Practice</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .hidden { display: none; }
    .click-target { 
      display: inline-block; 
      margin: 5px; 
      padding: 15px 20px; 
      background: #eee; 
      border-radius: 8px; 
      cursor: pointer; 
      border: 2px solid transparent;
      user-select: none;
      transition: all 0.2s ease;
    }
    .click-target.correct { background: #4ade80; border-color: #16a34a; }
    .click-target.incorrect { background: #f87171; border-color: #b91c1c; }
    .drag-container { display: flex; gap: 30px; justify-content: center; flex-wrap: wrap; margin-top: 20px; }
    .draggable { width: 60px; height: 60px; border-radius: 50%; background: #60a5fa; display:flex; align-items:center; justify-content:center; color:white; cursor: grab; user-select: none; transition: transform 0.2s ease; }
    .drop-zone { width: 60px; height: 60px; border: 2px dashed #ccc; border-radius: 50%; display:flex; align-items:center; justify-content:center; transition: all 0.2s ease; }
    .drop-zone.correct { border-color: #16a34a; background: #4ade80; }
    .drop-zone.incorrect { border-color: #b91c1c; background: #f87171; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

  <header class="bg-blue-600 text-white shadow-md fixed top-0 left-0 w-full z-50">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-2xl font-bold">Smart Learning Kids - Mouse</h1>
      <a href="index.html" class="bg-white text-blue-600 px-4 py-2 rounded-lg font-medium shadow hover:bg-blue-100 transition">Home</a>
    </div>
  </header>

  <main class="pt-24 max-w-4xl mx-auto px-4">
    <h2 class="text-3xl font-bold text-center mb-8">Mouse Practice</h2>
    <div id="accordion" class="space-y-4"></div>
  </main>

  <div id="mouseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl p-6 max-w-2xl w-full shadow-lg relative">
      <button id="closeModal" class="absolute top-2 right-2 text-red-600 text-xl font-bold">&times;</button>
      <h2 id="topicTitle" class="text-xl font-bold mb-2"></h2>
      <p id="topicInstruction" class="mb-4 bg-gray-100 p-3 rounded"></p>
      
      <div id="clickPractice" class="flex justify-center flex-wrap gap-4 mb-6"></div>
      <div id="dragPractice" class="drag-container mb-6"></div>

      <div class="flex justify-between mt-4">
        <button id="btnPrev" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">‚¨Ö Prev</button>
        <button id="btnRestart" class="px-4 py-2 bg-yellow-200 rounded hover:bg-yellow-300">üîÑ Restart</button>
        <button id="btnNext" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Next ‚û°</button>
      </div>
    </div>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", async () => {
    const container = document.getElementById("accordion");
    const modal = document.getElementById("mouseModal");
    const closeModal = document.getElementById("closeModal");
    const topicTitle = document.getElementById("topicTitle");
    const topicInstruction = document.getElementById("topicInstruction");
    const clickPractice = document.getElementById("clickPractice");
    const dragPractice = document.getElementById("dragPractice");
    const btnPrev = document.getElementById("btnPrev");
    const btnNext = document.getElementById("btnNext");
    const btnRestart = document.getElementById("btnRestart");

    let topics = [];
    let currentIndex = 0;

    try {
      const res = await fetch("data/mouse.json");
      const data = await res.json();
      topics = data.topics || [];

      topics.forEach((topic, idx) => {
        const btn = document.createElement("button");
        btn.className = "block w-full text-left px-4 py-2 rounded-lg shadow text-gray-900 bg-white hover:shadow-md hover:bg-blue-50 transition mb-2";
        btn.textContent = topic.title;
        btn.dataset.index = idx;
        container.appendChild(btn);
      });
    } catch (err) {
      console.error("Failed to load mouse.json", err);
      container.innerHTML = '<p class="text-red-500">‚ö†Ô∏è Failed to load mouse practice data.</p>';
    }

    function loadTopic(index) {
      const topic = topics[index];
      if (!topic) return;
      currentIndex = index;
      topicTitle.textContent = topic.title;
      topicInstruction.textContent = topic.instruction;
      clickPractice.innerHTML = "";
      dragPractice.innerHTML = "";

      // Click Practice
      if (topic.sample) {
        topic.sample.forEach(s => {
          const btn = document.createElement("div");
          btn.className = "click-target";
          btn.textContent = s;
          btn.addEventListener("click", () => {
            btn.classList.add("correct");
            setTimeout(() => btn.classList.remove("correct"), 500);
          });
          clickPractice.appendChild(btn);
        });
      }

      // Drag & Drop Practice
      if (topic.title === "Drag and Drop") {
        topic.sample.forEach((shape, i) => {
          const draggable = document.createElement("div");
          draggable.className = "draggable";
          draggable.textContent = shape[0];
          draggable.draggable = true;
          draggable.id = "drag-" + i;

          draggable.addEventListener("dragstart", e => {
            e.dataTransfer.setData("text/plain", draggable.id);
          });
          dragPractice.appendChild(draggable);

          const dropZone = document.createElement("div");
          dropZone.className = "drop-zone";
          dropZone.textContent = shape[0];

          dropZone.addEventListener("dragover", e => e.preventDefault());
          dropZone.addEventListener("drop", e => {
            e.preventDefault();
            const dragId = e.dataTransfer.getData("text/plain");
            const dragEl = document.getElementById(dragId);
            if (dragEl && dragEl.textContent === dropZone.textContent) {
              dropZone.classList.add("correct");
              dragEl.remove();
            } else {
              dropZone.classList.add("incorrect");
              setTimeout(() => dropZone.classList.remove("incorrect"), 500);
            }
          });

          dragPractice.appendChild(dropZone);
        });
      }

      modal.classList.remove("hidden");
    }

    container.addEventListener("click", e => {
      const btn = e.target.closest("button");
      if (!btn) return;
      loadTopic(parseInt(btn.dataset.index));
    });

    closeModal.addEventListener("click", () => modal.classList.add("hidden"));
    btnPrev.addEventListener("click", () => { if (currentIndex > 0) loadTopic(currentIndex - 1); });
    btnNext.addEventListener("click", () => { if (currentIndex < topics.length -1) loadTopic(currentIndex + 1); });
    btnRestart.addEventListener("click", () => loadTopic(currentIndex));

  });
  </script>
</body>
</html>
