<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart Learning Kids - Mouse Practice</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .accordion-body { max-height: 0; overflow: hidden; transition: max-height 0.5s ease; }
    .accordion-header span:last-child { transition: transform 0.3s ease; }
    .hidden { display: none; }
    .target {
      width: 50px; height: 50px; background: #3498db;
      border-radius: 50%; position: absolute; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: white; font-weight: bold; user-select: none;
      transition: transform 0.1s ease;
    }
    .stats span { margin-right: 15px; font-weight: bold; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

  <!-- Header -->
  <header class="bg-blue-600 text-white shadow-md fixed top-0 left-0 w-full z-50">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-2xl font-bold">Smart Learning Kids</h1>
      <a href="index.html" class="bg-white text-blue-600 px-4 py-2 rounded-lg font-medium shadow hover:bg-blue-100 transition">Home</a>
    </div>
  </header>

  <!-- Content -->
  <main class="pt-24 max-w-4xl mx-auto px-4">
    <h2 class="text-3xl font-bold text-center mb-8">Mouse Practice</h2>
    <div id="accordion" class="space-y-4"></div>
  </main>

  <!-- Modal -->
  <div id="mouseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl p-6 max-w-2xl w-full shadow-lg relative">
      <button id="closeMouse" class="absolute top-2 right-2 text-red-600 text-xl font-bold">&times;</button>
      <h2 id="mouseTitle" class="text-xl font-bold mb-4">Mouse Practice</h2>

      <!-- Instructions -->
      <div id="mouseInstruction" class="mb-4 p-3 bg-gray-100 rounded text-lg leading-relaxed"></div>

      <!-- Practice Area -->
      <div id="practiceArea" class="relative w-full h-64 bg-gray-200 rounded mb-4 overflow-hidden"></div>

      <!-- Stats -->
      <div class="stats flex justify-start text-sm font-semibold mb-4">
        <span>Clicks: <span id="clicks">0</span></span>
        <span>Hits: <span id="hits">0</span></span>
        <span>Accuracy: <span id="mouseAccuracy">100</span>%</span>
      </div>

      <div class="flex justify-between mt-4">
        <button id="btnPrevMouse" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">‚¨Ö Prev</button>
        <button id="btnRestartMouse" class="px-4 py-2 bg-yellow-200 rounded hover:bg-yellow-300">üîÑ Restart</button>
        <button id="btnNextMouse" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Next ‚û°</button>
      </div>
    </div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const container = document.getElementById("accordion");

  const mouseModal = document.getElementById("mouseModal");
  const closeMouse = document.getElementById("closeMouse");
  const mouseTitle = document.getElementById("mouseTitle");
  const mouseInstruction = document.getElementById("mouseInstruction");
  const practiceArea = document.getElementById("practiceArea");
  const clicksEl = document.getElementById("clicks");
  const hitsEl = document.getElementById("hits");
  const accuracyEl = document.getElementById("mouseAccuracy");

  const btnPrevMouse = document.getElementById("btnPrevMouse");
  const btnNextMouse = document.getElementById("btnNextMouse");
  const btnRestartMouse = document.getElementById("btnRestartMouse");

  let currentTopics = [];
  let currentIndex = 0;
  let clicks = 0;
  let hits = 0;

  function resetStats() {
    clicks = 0;
    hits = 0;
    clicksEl.textContent = clicks;
    hitsEl.textContent = hits;
    accuracyEl.textContent = 100;
  }
// framework for different mouse practice types
   function spawnTarget() {
    practiceArea.innerHTML = '';
    const target = document.createElement("div");
    target.className = "target";
    target.textContent = "üéØ";
    const areaRect = practiceArea.getBoundingClientRect();
    const size = 50;
    const x = Math.random() * (areaRect.width - size);
    const y = Math.random() * (areaRect.height - size);
    target.style.left = x + "px";
    target.style.top = y + "px";
    practiceArea.appendChild(target);

    target.addEventListener("click", e => {
      hits++;
      clicks++;
      updateStats();
      spawnTarget();
    });
  }
function updateStats() {
    clicksEl.textContent = clicks;
    hitsEl.textContent = hits;
    const accuracy = clicks > 0 ? Math.round((hits / clicks) * 100) : 100;
    accuracyEl.textContent = accuracy;
  }
function loadMouseTopic(topic) {
    mouseTitle.textContent = topic.dataset.title;
    mouseInstruction.textContent = topic.dataset.sample;
    resetStats();
    spawnTarget();
    mouseModal.classList.remove("hidden");
  }
try {
    const res = await fetch("data/mouse.json");
    const data = await res.json();
    const years = Array.isArray(data) ? data : data.years;

    years.forEach(year => {
      const card = document.createElement("div");
      card.className = "bg-white rounded-xl shadow-md overflow-hidden mb-4";

      // Accordion header
      const header = document.createElement("button");
      header.className = "accordion-header w-full flex justify-between items-center px-6 py-4 text-lg font-semibold bg-green-100 hover:bg-green-200 transition";
      header.innerHTML = `<span class="text-gray-900">${year.name}</span><span class="text-gray-900">+</span>`;
      card.appendChild(header);

      // Accordion body
      const body = document.createElement("div");
      body.className = "accordion-body bg-gray-50 px-4 py-0 overflow-hidden";

      const ul = document.createElement("ul");
      ul.className = "space-y-2 pl-6";

      // Loop through topics directly
      (year.topics || []).forEach(topic => {
        const li = document.createElement("li");

        const btn = document.createElement("button");
        btn.className = "topicBtn block w-full text-left px-4 py-2 rounded-lg shadow text-gray-900 bg-white hover:shadow-md hover:bg-green-50 transition flex items-center gap-2";
        btn.dataset.title = topic.title;
        btn.dataset.sample = topic.sample;
        btn.textContent = `üñ±Ô∏è ${topic.title}`;

        li.appendChild(btn);
        ul.appendChild(li);
      });

      body.appendChild(ul);
      card.appendChild(body);

      // Accordion toggle
      header.addEventListener("click", () => {
        const isOpen = body.style.maxHeight && body.style.maxHeight !== "0px";
        container.querySelectorAll(".accordion-body").forEach(el => el.style.maxHeight = null);
        container.querySelectorAll(".accordion-header span:last-child").forEach(icon => icon.style.transform = "rotate(0deg)");
        if (!isOpen) {
          body.style.maxHeight = body.scrollHeight + "px";
          header.querySelector("span:last-child").style.transform = "rotate(45deg)";
        }
      });

      container.appendChild(card);
    });

    // Topic modal click
    container.addEventListener("click", e => {
      const btn = e.target.closest(".topicBtn");
      if (!btn) return;
      currentTopics = [...btn.closest("ul").querySelectorAll(".topicBtn")];
      currentIndex = currentTopics.indexOf(btn);
      loadMouseTopic(btn);
    });

  } catch (err) {
    console.error("Error loading mouse.json:", err);
    container.innerHTML = '<p class="text-red-500">‚ö†Ô∏è Failed to load mouse data.</p>';
  }

  // Modal navigation
  btnNextMouse.addEventListener("click", () => {
    if (currentIndex < currentTopics.length - 1) currentIndex++;
    loadMouseTopic(currentTopics[currentIndex]);
  });

  btnPrevMouse.addEventListener("click", () => {
    if (currentIndex > 0) currentIndex--;
    loadMouseTopic(currentTopics[currentIndex]);
  });

  btnRestartMouse.addEventListener("click", () => {
    if (currentTopics.length > 0) loadMouseTopic(currentTopics[currentIndex]);
  });

  closeMouse.addEventListener("click", () => {
    mouseModal.classList.add("hidden");
    practiceArea.innerHTML = '';
  });

  // Count misses
  practiceArea.addEventListener("click", e => {
    if (!e.target.classList.contains("target")) {
      clicks++;
      updateStats();
    }
  });
});
</script>
</body>
</html>
