<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart Learning Kids - Mouse Practice</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .accordion-body { max-height: 0; overflow: hidden; transition: max-height 0.5s ease; }
    .accordion-header span:last-child { transition: transform 0.3s ease; }
    .hidden { display: none; }
    .click-target { 
      display: inline-block; 
      margin: 10px; 
      padding: 20px; 
      background: #eee; 
      border-radius: 8px; 
      cursor: pointer; 
      border: 2px solid transparent;
      user-select: none;
    }
    .click-target.correct { background: #4ade80; border-color: #16a34a; }
    .click-target.incorrect { background: #f87171; border-color: #b91c1c; }
    .drag-container { display: flex; gap: 40px; justify-content: center; flex-wrap: wrap; margin-top: 20px; }
    .draggable { width: 60px; height: 60px; border-radius: 50%; background: #60a5fa; display:flex; align-items:center; justify-content:center; color:white; cursor: grab; }
    .drop-zone { width: 60px; height: 60px; border: 2px dashed #ccc; border-radius: 50%; display:flex; align-items:center; justify-content:center; }
    .drop-zone.correct { border-color: #16a34a; background: #4ade80; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

  <!-- Header -->
  <header class="bg-blue-600 text-white shadow-md fixed top-0 left-0 w-full z-50">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-2xl font-bold">Smart Learning Kids - Mouse</h1>
      <a href="index.html" class="bg-white text-blue-600 px-4 py-2 rounded-lg font-medium shadow hover:bg-blue-100 transition">Home</a>
    </div>
  </header>

  <!-- Content -->
  <main class="pt-24 max-w-4xl mx-auto px-4">
    <h2 class="text-3xl font-bold text-center mb-8">Mouse Practice</h2>
    <div id="accordion" class="space-y-4"></div>
  </main>

  <!-- Modal -->
  <div id="mouseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl p-6 max-w-2xl w-full shadow-lg relative">
      <button id="closeMouse" class="absolute top-2 right-2 text-red-600 text-xl font-bold">&times;</button>
      <h2 id="mouseTitle" class="text-xl font-bold mb-4">Mouse Practice</h2>

      <div id="mouseInstruction" class="mb-4 bg-gray-100 p-3 rounded"></div>

      <div id="clickPractice" class="flex justify-center flex-wrap gap-4 mb-4"></div>
      <div id="dragPractice" class="drag-container"></div>

      <div class="flex justify-between mt-4">
        <button id="btnPrevMouse" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">‚¨Ö Prev</button>
        <button id="btnRestartMouse" class="px-4 py-2 bg-yellow-200 rounded hover:bg-yellow-300">üîÑ Restart</button>
        <button id="btnNextMouse" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Next ‚û°</button>
      </div>
    </div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const container = document.getElementById("accordion");
  const mouseModal = document.getElementById("mouseModal");
  const closeMouse = document.getElementById("closeMouse");
  const mouseTitle = document.getElementById("mouseTitle");
  const mouseInstruction = document.getElementById("mouseInstruction");
  const clickPractice = document.getElementById("clickPractice");
  const dragPractice = document.getElementById("dragPractice");
  const btnPrevMouse = document.getElementById("btnPrevMouse");
  const btnNextMouse = document.getElementById("btnNextMouse");
  const btnRestartMouse = document.getElementById("btnRestartMouse");

  let topics = [];
  let currentIndex = 0;

  // Fetch mouse.json
  try {
    const res = await fetch("data/mouse.json");
    const data = await res.json();
    topics = data.topics || [];

    topics.forEach((topic, idx) => {
      const btn = document.createElement("button");
      btn.className = "block w-full text-left px-4 py-2 rounded-lg shadow text-gray-900 bg-white hover:shadow-md hover:bg-green-50 transition mb-2";
      btn.textContent = topic.title;
      btn.dataset.index = idx;
      btn.dataset.title = topic.title;
      btn.dataset.instruction = topic.instruction;
      btn.dataset.content = JSON.stringify(topic.sample);
      container.appendChild(btn);
    });

  } catch (err) {
    console.error("Failed to load mouse.json", err);
    container.innerHTML = '<p class="text-red-500">‚ö†Ô∏è Failed to load mouse practice data.</p>';
  }

  function loadMouseTopic(btn) {
    currentIndex = parseInt(btn.dataset.index);
    mouseTitle.textContent = btn.dataset.title;
    mouseInstruction.textContent = btn.dataset.instruction;

    const sample = JSON.parse(btn.dataset.content);

    clickPractice.innerHTML = '';
    dragPractice.innerHTML = '';

    if (btn.dataset.title === "Mouse Clicks") {
      sample.forEach(item => {
        const target = document.createElement("div");
        target.className = "click-target";
        target.textContent = item;
        target.addEventListener("click", () => {
          target.classList.add("correct");
          setTimeout(() => target.classList.remove("correct"), 500);
        });
        clickPractice.appendChild(target);
      });
    }

    if (btn.dataset.title === "Drag and Drop") {
      sample.forEach((shape, i) => {
        const draggable = document.createElement("div");
        draggable.className = "draggable";
        draggable.textContent = shape[0];
        draggable.draggable = true;
        draggable.id = "drag-" + i;

        draggable.addEventListener("dragstart", e => {
          e.dataTransfer.setData("text/plain", draggable.id);
        });

        dragPractice.appendChild(draggable);

        const dropZone = document.createElement("div");
        dropZone.className = "drop-zone";
        dropZone.textContent = shape[0];
        dropZone.addEventListener("dragover", e => e.preventDefault());
        dropZone.addEventListener("drop", e => {
          e.preventDefault();
          const dragId = e.dataTransfer.getData("text/plain");
          const dragEl = document.getElementById(dragId);
          if (dragEl && dragEl.textContent === dropZone.textContent) {
            dropZone.classList.add("correct");
            dragEl.remove();
          } else {
            dropZone.classList.add("incorrect");
            setTimeout(() => dropZone.classList.remove("incorrect"), 500);
          }
        });

        dragPractice.appendChild(dropZone);
      });
    }

    mouseModal.classList.remove("hidden");
  }

  // Accordion button click
  container.addEventListener("click", e => {
    const btn = e.target.closest("button");
    if (!btn) return;
    loadMouseTopic(btn);
  });

  closeMouse.addEventListener("click", () => {
    mouseModal.classList.add("hidden");
    clickPractice.innerHTML = '';
    dragPractice.innerHTML = '';
  });

  // Navigation buttons
  btnPrevMouse.addEventListener("click", () => {
    if (currentIndex > 0) loadMouseTopic(container.children[currentIndex - 0]);
  });
  btnNextMouse.addEventListener("click", () => {
    if (currentIndex < topics.length - 1) loadMouseTopic(container.children[currentIndex + 0]);
  });
  btnRestartMouse.addEventListener("click", () => loadMouseTopic(container.children[currentIndex]));
});
</script>
</body>
</html>
