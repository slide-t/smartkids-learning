<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart Learning Kids - Classes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .accordion-body { max-height: 0; overflow: hidden; transition: max-height 0.5s ease; }
    .accordion-header span:last-child { transition: transform 0.3s ease; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

  <!-- Header -->
  <header class="bg-blue-600 text-white shadow-md fixed top-0 left-0 w-full z-50">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-2xl font-bold">Smart Learning Kids</h1>
      <a href="index.html" class="bg-white text-blue-600 px-4 py-2 rounded-lg font-medium shadow hover:bg-blue-100 transition">Home</a>
    </div>
  </header>

  <!-- Content -->
  <main class="pt-24 max-w-4xl mx-auto px-4">
    <h2 class="text-3xl font-bold text-center mb-8">Select Your Class</h2>
    <div id="accordion" class="space-y-4"></div>
  </main>
  
<script>
document.addEventListener("DOMContentLoaded", () => {
  const container = document.getElementById("accordion");
  const today = new Date();
  const termUnlockDates = { 2: new Date("2026-01-04"), 3: new Date("2026-04-20") };

  // ✅ Lessons JSON (Year 1 & 2, 3 terms each)
  const classes = [
    {
      id: "year1",
      name: "Year 1",
      terms: [
        {
          number: 1,
          title: "Term 1",
          categories: [
            {
              id: "keyboard",
              name: "Keyboard Basics",
              topics: [
                { title: "Home Row Keys" },
                { title: "Basic Words" }
              ]
            }
          ]
        },
        {
          number: 2,
          title: "Term 2",
          categories: [
            {
              id: "keyboard",
              name: "Keyboard Practice",
              topics: [
                { title: "Left Hand Keys" },
                { title: "Right Hand Keys" }
              ]
            }
          ]
        },
        {
          number: 3,
          title: "Term 3",
          categories: [
            {
              id: "keyboard",
              name: "Typing Sentences",
              topics: [
                { title: "Simple Sentences" },
                { title: "Punctuation Practice" }
              ]
            }
          ]
        }
      ]
    },
    {
      id: "year2",
      name: "Year 2",
      terms: [
        {
          number: 1,
          title: "Term 1",
          categories: [
            {
              id: "keyboard",
              name: "Typing Words",
              topics: [
                { title: "Simple Words" },
                { title: "Short Sentences" }
              ]
            }
          ]
        },
        {
          number: 2,
          title: "Term 2",
          categories: [
            {
              id: "keyboard",
              name: "Typing Practice",
              topics: [
                { title: "Story Sentences" },
                { title: "Numbers Practice" }
              ]
            }
          ]
        },
        {
          number: 3,
          title: "Term 3",
          categories: [
            {
              id: "keyboard",
              name: "Advanced Typing",
              topics: [
                { title: "Paragraph Practice" },
                { title: "Timed Practice" }
              ]
            }
          ]
        }
      ]
    }
  ];

  // ✅ Render accordion
  classes.forEach((cls) => {
    const card = document.createElement("div");
    card.className = "bg-white rounded-xl shadow-md overflow-hidden mb-4";

    const header = document.createElement("button");
    header.className = "accordion-header w-full flex justify-between items-center px-6 py-4 text-lg font-semibold bg-blue-100 hover:bg-blue-200 transition";
    header.innerHTML = `<span class="text-gray-900">${cls.name}</span><span class="text-gray-900">+</span>`;
    card.appendChild(header);

    const body = document.createElement("div");
    body.className = "accordion-body bg-gray-50";

    body.innerHTML = (cls.terms || []).map(term => {
      const termUnlocked = term.number === 1 || today >= termUnlockDates[term.number];
      return `
        <div class="mb-4">
          <h3 class="text-lg font-semibold text-blue-700 px-4 py-2">${term.title}</h3>
          ${(term.categories || []).map(cat => `
            <div class="ml-4 mb-2">
              <h4 class="text-md font-semibold text-purple-600 px-3 py-1">${cat.name}</h4>
              <ul class="space-y-2 pl-6">
                ${(cat.topics || []).map((topic, topicIndex) => {
                  if (termUnlocked) {
                    const link = \`game-board.html?year=\${cls.id}&term=\${term.number}&catId=\${cat.id}&topic=\${topicIndex}\`;
                    return `<li>
                      <a href="\${link}" class="lesson-link block px-4 py-2 rounded-lg shadow text-gray-900 bg-white hover:shadow-md hover:bg-blue-50 transition flex items-center gap-2">
                        ⌨️ ${topic.title}
                      </a>
                    </li>`;
                  } else {
                    return `<li>
                      <span class="block px-4 py-2 rounded-lg shadow text-base bg-gray-200 text-gray-500 cursor-not-allowed flex items-center gap-2">
                        ⌨️ ${topic.title} (Locked)
                      </span>
                    </li>`;
                  }
                }).join("")}
              </ul>
            </div>
          `).join("")}
        </div>`;
    }).join("");

    card.appendChild(body);

    // Toggle accordion
    header.addEventListener("click", () => {
      const isOpen = body.style.maxHeight && body.style.maxHeight !== "0px";
      container.querySelectorAll(".accordion-body").forEach(el => el.style.maxHeight = null);
      container.querySelectorAll(".accordion-header span:last-child").forEach(icon => icon.style.transform = "rotate(0deg)");
      if (!isOpen) {
        body.style.maxHeight = body.scrollHeight + "px";
        header.querySelector("span:last-child").style.transform = "rotate(45deg)";
      }
    });

    container.appendChild(card);
  });

  // ✅ Auto-close accordion on lesson click
  container.addEventListener("click", (e) => {
    if (e.target.closest(".lesson-link")) {
      container.querySelectorAll(".accordion-body").forEach(el => el.style.maxHeight = null);
      container.querySelectorAll(".accordion-header span:last-child").forEach(icon => icon.style.transform = "rotate(0deg)");
    }
  });

});
</script>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js').then(() => {
    console.log('✅ Service worker registered');
  });
}
</script>
</body>
</html>
